Cursor 开发约束文档（VidSlide AI 专用）

生效范围: VidSlide AI 项目所有开发活动
约束级别: 强制（违反将导致项目偏离技术文档要求）
关联技术文档: VidSlide AI - 分阶段技术文档 V2.3（紧急补齐版）
紧急调整依据: 综合分析报告显示存在严重功能缺失，需优先补齐核心功能
一、核心约束

开发模式约束
严格遵循「一人开发」模式，禁止引入任何需要团队协作的工具 / 流程（如 GitFlow、CI/CD 流水线等）
禁止使用任何需要后端支持的服务（如数据库、云函数、在线 API 等，FFmpeg 核心文件 CDN 缓存除外）
所有功能必须在浏览器端完成，禁止编写任何 Node.js 后端代码
技术文档遵循约束
必须严格遵循《VidSlide AI - 分阶段技术文档 V2.2》的所有要求，禁止偏离
禁止自行扩展技术文档未提及的功能或技术方案
所有开发活动必须对应技术文档中的明确要求，禁止无依据的联想或创新
分阶段开发约束
必须严格按照 22 周分三阶段开发，禁止跨阶段提前实现功能
每阶段必须通过验收标准才能进入下一阶段，禁止跳过验收
每周必须完成对应周计划的任务，禁止超前或滞后
二、技术栈约束

允许使用的技术栈（严格遵循技术文档）
前端框架：Vue 3 + Composition API
状态管理：Pinia
UI 组件：Element Plus
视频处理：FFmpeg.wasm（主） + MediaRecorder（降级）
AI 功能：Whisper.cpp WASM（仅阶段二）、Face-api.js（仅阶段二，Chrome 限定）
导出功能：PPTXGenJS（仅阶段三静态内容）
外部API（素材获取）：
- 百度翻译API（关键词翻译）
- Unsplash API（免费素材图片）
- Pexels API（免费素材视频/图片）
- 外部版权验证API（素材版权检查）
测试工具：Vitest + Playwright
构建工具：Vite
部署平台：Vercel
禁止使用的技术
禁止使用 React、Angular 等非 Vue 框架
禁止使用 Vuex、Redux 等非 Pinia 状态管理工具
禁止使用除 FFmpeg.wasm 外的其他视频处理库
禁止使用任何在线 AI 服务（如 OpenAI API、百度 AI 等）
禁止使用任何后端语言或框架（如 Node.js、Python、Java 等）
禁止使用任何数据库（如 MySQL、MongoDB、Firebase 等）
三、分阶段开发约束

阶段一（Week1-6）约束
仅允许实现基础原型功能：视频上传、播放、时间轴、卡片编辑、基础 MP4 导出（MediaRecorder）
禁止实现任何 AI 相关功能（语音转文字、人脸跟踪等）
禁止使用 FFmpeg.wasm（阶段三才允许）
必须完成所有阶段一的单元测试和集成测试
阶段二（Week7-14）约束
仅允许实现 AI 增强功能：Whisper.cpp WASM 语音转文字、Face-api.js 人脸跟踪（Chrome 限定）、智能推荐
禁止实现阶段三的商业化功能（水印、4K 导出、PPTX 导出等）
必须处理 WASM 加载失败的降级逻辑
必须完成所有阶段二的 AI 功能测试
阶段三（Week15-22）约束
仅允许实现商业化功能：FFmpeg.wasm 4K 导出、PPTX 导出、水印、使用限制
必须严格遵循技术文档中的商业化规则（免费用户 1080p、付费用户 4K 等）
必须完成所有阶段三的性能测试和兼容性测试
🚨 紧急补齐阶段（Week23-32）约束
补齐README.md定义的完整核心功能，实现完整工作流程
必须实现的核心功能：模板引擎、用户调整、画中画效果、素材管理、动画系统、AI内容分析
允许实现README.md明确要求的AI功能：语音识别、内容分析、关键帧检测、素材匹配
禁止实现阶段三商业化功能：FFmpeg 4K导出、水印、使用限制
优化完善阶段（Week33-36）约束
仅在完成紧急补齐阶段所有验收标准后，才能进入优化完善阶段
必须基于用户反馈进行迭代优化，不得新增核心功能
四、质量与测试约束

测试约束
所有功能必须编写对应的单元测试（Vitest）
核心流程必须编写集成测试（Playwright）
紧急补齐阶段测试覆盖率≥80%，禁止提交覆盖率不足的代码
每个开发单元完成后必须执行完整的测试流程：单元测试→集成测试→E2E测试→性能测试
禁止提交未通过任何测试的代码
验收测试约束
每个单元完成后必须对照README.md需求进行功能验收
必须通过用户体验测试（操作便捷性、视觉一致性）
必须通过兼容性测试（Chrome/Safari/Firefox）
验收失败的单元必须退回重新开发，不得进入下一单元
性能约束
必须满足技术文档中的性能指标（如模板渲染<100ms、素材加载<500ms）
必须使用 Web Worker 处理重任务，禁止阻塞主线程
必须优化内存使用，模板渲染内存<50MB
兼容性约束
必须支持技术文档中的浏览器（Chrome90+、Firefox88+、Safari14+）
必须实现完整的降级策略（Canvas2D降级、MediaRecorder降级）
质量检查约束
代码必须通过ESLint检查，禁止任何代码质量警告
必须编写完整的JSDoc注释，覆盖所有公共API
必须通过安全扫描，禁止XSS等安全漏洞
必须进行内存泄漏检查，确保无内存泄漏
五、隐私合规约束

数据处理约束
所有核心数据必须在本地处理，仅允许技术文档中明确授权的网络请求
禁止收集任何用户数据（除本地存储的项目数据外）
禁止上传任何用户视频 / 音频到服务器
允许的外部API调用（仅用于素材获取）：
- 百度翻译API：仅传输关键词进行翻译，不包含用户视频内容
- Unsplash API：获取免费素材图片，基于用户授权的关键词搜索
- Pexels API：获取免费素材视频/图片，基于用户授权的关键词搜索
- 版权验证API：验证素材版权状态，不上传用户内容
必须使用技术文档中的 PrivacyAuditor 工具检查网络请求
FFmpeg 缓存约束
仅允许缓存技术文档中指定的 FFmpeg 核心文件
禁止缓存任何用户数据或其他文件
允许缓存外部素材API下载的素材文件（Unsplash、Pexels等）
必须使用 IndexedDB 缓存外部素材，禁止使用 localStorage
必须实现LRU缓存策略，控制缓存大小不超过500MB
六、错误处理约束

必须处理的错误场景
WASM 加载失败（FFmpeg、Whisper）
视频 / 音频解码失败
导出失败
浏览器兼容性问题
内存不足问题
外部API调用失败（网络超时、API限制、密钥错误）
素材下载失败（版权问题、网络问题）
翻译服务失败（API不可用、翻译错误）
错误处理要求
所有异步操作必须有 try/catch
必须提供用户友好的错误提示
必须实现降级策略（如 WASM 失败时使用 MediaRecorder）
禁止直接抛出错误给用户
七、避免过度开发约束

功能范围约束
禁止实现技术文档未提及的功能
禁止在紧急补齐阶段添加任何非核心功能
允许实现README.md中定义的外部素材获取功能：
- 用户授权的外部API调用（Unsplash、Pexels）
- 百度翻译API（关键词翻译）
- 外部版权验证API
必须严格对照README.md需求实现功能，不得多不少
UI设计约束
允许使用V0等设计工具进行现有UI优化，但必须：
- 仅优化README.md已定义的界面，不得添加新功能
- 设计结果符合技术文档的组件和样式规范
- 最终实现必须在Vue 3 + Element Plus技术栈内完成
- 不得违反功能完整性和代码规模约束
功能完整性约束
紧急补齐阶段必须实现README.md中描述的完整功能
允许实现的完整外部API功能：
- 百度翻译API（完整翻译流程和缓存）
- Unsplash/Pexels API（完整素材搜索和下载）
- 版权验证API（完整版权检查流程）
禁止功能降级或简化实现（除非技术受限）
必须实现用户可调整的所有功能点
代码规模约束
紧急补齐阶段代码量控制在15000行以内
禁止编写冗余代码，保持代码简洁性
依赖约束
禁止添加技术栈外的依赖（外部API功能除外）
允许添加外部API功能所需的依赖：
- 百度翻译API客户端库
- Unsplash/Pexels API客户端库
- 版权验证API客户端库
禁止升级依赖版本（除非技术文档要求）
必须使用技术文档中指定的依赖版本
功能优先级约束
P0功能（模板引擎、用户调整、画中画效果）必须100%完成
P1功能（素材管理、动画系统）必须在P0完成后实现
禁止跨优先级开发功能
八、代码风格约束

必须遵循的风格
使用 Vue3 的 Composition API（禁止 Options API）
使用 Pinia 的 setup 语法
使用 ESLint+Prettier（技术文档中的配置）
代码注释率≥20%
命名约束
组件名：大驼峰 + 后缀（如 VideoPlayer.vue）
函数名：小驼峰（如 exportVideo ()）
变量名：小驼峰（如 videoSrc）
常量名：大写下划线（如 MAX_VIDEO_SIZE）
九、其他约束

文档约束
必须每周更新开发文档
必须记录所有技术决策和验收结果
必须编写用户手册和API文档
验收记录约束
每个单元完成后必须记录验收结果
必须记录测试覆盖率和性能指标
必须记录发现的问题和解决方案
备份约束
必须使用技术文档中的 BackupService 工具
必须每天备份代码
必须保留所有历史版本
开发流程约束
必须按照"开发→测试→验收→记录"的流程执行
禁止在验收失败时进入下一阶段
必须在代码审查通过后才能合并
质量监控约束
必须监控代码质量指标（圈复杂度、重复代码率）
必须监控性能指标（加载时间、内存使用）
必须监控用户体验指标（操作步骤、错误率）
Cursor 使用约束
每次生成代码前必须检查是否符合约束
每次生成代码后必须提醒检查测试和错误处理
必须使用 /g 命令验证约束合规性
禁止使用 Cursor 的 "自动重构" 功能（除非技术文档要求重构）
禁止使用 Cursor 的 "扩展功能" 建议
开发日志记录约束
必须在代码注释中记录实现的功能点
必须标注当前实现的阶段和优先级
必须记录技术决策和权衡考虑
开发节奏约束
紧急补齐阶段每周必须完成分配的任务
禁止拖延或提前开发下一阶段内容
必须保证开发质量，不得牺牲质量换取速度

十、紧急补齐阶段专项约束

功能完整性强制要求
必须100%实现README.md中定义的所有功能点
禁止任何形式的"技术性降级"或功能简化
验收标准必须与README.md需求完全一致
测试执行强制要求
每个开发单元完成后必须执行完整测试流程：
1. 单元测试（覆盖率≥80%）
2. 集成测试（核心流程）
3. E2E测试（用户操作流程）
4. 性能测试（各项指标达标）
5. 用户验收测试（对照需求文档）
验收失败处理机制
功能不完整：立即退回开发，补充缺失功能
性能不达标：进行性能优化，直至达标
用户体验差：重新设计UI/UX
兼容性问题：实现降级方案
代码质量问题：重构代码，修复问题
进度管控要求
P0功能必须在Week23-28完成
P1功能必须在Week29-32完成
禁止任何跨优先级或跨阶段的开发
质量监控指标
代码质量：ESLint 0错误，测试覆盖率≥80%
性能指标：各功能模块达到技术文档要求
用户体验：操作便捷，视觉专业
兼容性：支持主流浏览器和设备
外部API监控：网络请求成功率≥95%，响应时间<3秒
素材缓存：缓存命中率≥70%，缓存大小控制在合理范围内
风险控制措施
每日进行代码备份和状态记录
每周进行技术风险评估
遇到技术障碍时及时调整方案
保持与技术文档的严格一致性
