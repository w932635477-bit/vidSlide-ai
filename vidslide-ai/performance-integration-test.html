<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VidSlide AI - æ€§èƒ½ä¸é›†æˆæµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 30px;
        }

        .test-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .test-card h3 {
            margin: 0 0 10px 0;
            color: #495057;
            font-size: 1.2em;
        }

        .test-card p {
            margin: 0;
            color: #6c757d;
            font-size: 0.9em;
        }

        .run-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .run-button:hover {
            background: #218838;
        }

        .run-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .results {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .results.show {
            display: block;
        }

        .result-section {
            margin-bottom: 30px;
        }

        .result-section h4 {
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
        }

        .metric-value {
            font-family: 'Monaco', 'Menlo', monospace;
            color: #667eea;
        }

        .status-success {
            color: #28a745;
        }

        .status-error {
            color: #dc3545;
        }

        .status-warning {
            color: #ffc107;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }

        .summary h3 {
            margin: 0 0 10px 0;
            font-size: 1.5em;
        }

        .summary p {
            margin: 5px 0;
            opacity: 0.9;
        }

        .recommendations {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .recommendations h4 {
            color: #856404;
            margin: 0 0 10px 0;
        }

        .recommendations ul {
            margin: 0;
            padding-left: 20px;
        }

        .recommendations li {
            color: #856404;
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }

            .test-controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ VidSlide AI</h1>
            <p>æ€§èƒ½ä¸é›†æˆæµ‹è¯•å¥—ä»¶</p>
        </div>

        <div class="content">
            <div class="test-controls">
                <div class="test-card" onclick="runPerformanceTest()">
                    <h3>âš¡ æ€§èƒ½æµ‹è¯•</h3>
                    <p>æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½çš„æ€§èƒ½è¡¨ç°</p>
                </div>

                <div class="test-card" onclick="runIntegrationTest()">
                    <h3>ğŸ”— é›†æˆæµ‹è¯•</h3>
                    <p>æµ‹è¯•åŠŸèƒ½æ¨¡å—é—´çš„ååŒå·¥ä½œ</p>
                </div>

                <div class="test-card" onclick="runFullSuite()">
                    <h3>ğŸ¯ å®Œæ•´æµ‹è¯•</h3>
                    <p>è¿è¡Œæ€§èƒ½å’Œé›†æˆæµ‹è¯•çš„å®Œæ•´å¥—ä»¶</p>
                </div>
            </div>

            <div style="text-align: center; margin-bottom: 30px;">
                <button id="runButton" class="run-button" onclick="runFullSuite()">
                    å¼€å§‹å®Œæ•´æµ‹è¯•å¥—ä»¶
                </button>
            </div>

            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>

            <div id="results" class="results">
                <!-- æµ‹è¯•ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>
    </div>

    <script src="performance-test-suite.js"></script>
    <script src="integration-test-suite.js"></script>

    <script>
        let currentTest = null;
        let progressInterval = null;

        function updateProgress(percent) {
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = percent + '%';
        }

        function showResults(results, testType) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.add('show');

            let html = `<div class="result-section">
                <h4>${testType} æµ‹è¯•ç»“æœ</h4>`;

            // å°†ç»“æœå¯¹è±¡è½¬æ¢ä¸ºHTML
            html += objectToHtml(results);

            html += '</div>';
            resultsDiv.innerHTML = html;
        }

        function objectToHtml(obj, indent = 0) {
            let html = '';

            for (const [key, value] of Object.entries(obj)) {
                if (key === 'recommendations' && Array.isArray(value)) {
                    html += `<div class="recommendations">
                        <h4>ğŸ’¡ ä¼˜åŒ–å»ºè®®</h4>
                        <ul>`;
                    value.forEach(rec => {
                        html += `<li>${rec}</li>`;
                    });
                    html += '</ul></div>';
                } else if (typeof value === 'object' && value !== null) {
                    if (value.status !== undefined) {
                        const statusClass = value.status === 'success' ? 'status-success' :
                                          value.status === 'error' ? 'status-error' : 'status-warning';
                        html += `<div class="metric">
                            <span class="metric-label">${key}:</span>
                            <span class="metric-value ${statusClass}">${value.status.toUpperCase()}</span>
                        </div>`;
                    } else {
                        html += `<div class="metric">
                            <span class="metric-label">${key}:</span>
                            <span class="metric-value">${typeof value === 'number' ? value.toFixed(2) : JSON.stringify(value)}</span>
                        </div>`;
                    }
                } else {
                    const displayValue = typeof value === 'number' && key.toLowerCase().includes('time') ?
                        value.toFixed(2) + 'ms' : value;
                    html += `<div class="metric">
                        <span class="metric-label">${key}:</span>
                        <span class="metric-value">${displayValue}</span>
                    </div>`;
                }
            }

            return html;
        }

        function showSummary(results, testType) {
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'summary';

            let score, rating, recommendations;

            if (testType === 'æ€§èƒ½') {
                score = results.overall.performanceScore;
                rating = results.overall.rating;
                recommendations = results.overall.recommendations;
            } else if (testType === 'é›†æˆ') {
                score = results.overall.integrationScore;
                rating = results.overall.health;
                recommendations = results.overall.recommendations;
            }

            summaryDiv.innerHTML = `
                <h3>${testType}æµ‹è¯•å®Œæˆ</h3>
                <p>ç»¼åˆè¯„åˆ†: <strong>${score.toFixed(1)}/100</strong></p>
                <p>ç­‰çº§: <strong>${rating}</strong></p>
                <p>å»ºè®®: ${recommendations.join('ï¼Œ')}</p>
            `;

            const resultsDiv = document.getElementById('results');
            resultsDiv.appendChild(summaryDiv);
        }

        async function runPerformanceTest() {
            const button = document.getElementById('runButton');
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span>è¿è¡Œæ€§èƒ½æµ‹è¯•ä¸­...';

            currentTest = 'performance';
            updateProgress(0);

            try {
                const suite = new PerformanceTestSuite();

                // æ¨¡æ‹Ÿè¿›åº¦æ›´æ–°
                progressInterval = setInterval(() => {
                    const currentProgress = parseFloat(document.getElementById('progressFill').style.width || '0%');
                    if (currentProgress < 90) {
                        updateProgress(currentProgress + 5);
                    }
                }, 500);

                const results = await suite.runFullSuite();

                clearInterval(progressInterval);
                updateProgress(100);

                showResults(results, 'æ€§èƒ½');
                showSummary(results, 'æ€§èƒ½');

            } catch (error) {
                console.error('æ€§èƒ½æµ‹è¯•å¤±è´¥:', error);
                clearInterval(progressInterval);
                updateProgress(0);
            }

            button.disabled = false;
            button.innerHTML = 'å¼€å§‹å®Œæ•´æµ‹è¯•å¥—ä»¶';
            currentTest = null;
        }

        async function runIntegrationTest() {
            const button = document.getElementById('runButton');
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span>è¿è¡Œé›†æˆæµ‹è¯•ä¸­...';

            currentTest = 'integration';
            updateProgress(0);

            try {
                const suite = new IntegrationTestSuite();

                // æ¨¡æ‹Ÿè¿›åº¦æ›´æ–°
                progressInterval = setInterval(() => {
                    const currentProgress = parseFloat(document.getElementById('progressFill').style.width || '0%');
                    if (currentProgress < 90) {
                        updateProgress(currentProgress + 3);
                    }
                }, 800);

                const results = await suite.runFullSuite();

                clearInterval(progressInterval);
                updateProgress(100);

                showResults(results, 'é›†æˆ');
                showSummary(results, 'é›†æˆ');

            } catch (error) {
                console.error('é›†æˆæµ‹è¯•å¤±è´¥:', error);
                clearInterval(progressInterval);
                updateProgress(0);
            }

            button.disabled = false;
            button.innerHTML = 'å¼€å§‹å®Œæ•´æµ‹è¯•å¥—ä»¶';
            currentTest = null;
        }

        async function runFullSuite() {
            const button = document.getElementById('runButton');
            button.disabled = true;

            // æ¸…ç©ºä¹‹å‰çš„æµ‹è¯•ç»“æœ
            document.getElementById('results').innerHTML = '';

            try {
                // å…ˆè¿è¡Œæ€§èƒ½æµ‹è¯•
                button.innerHTML = '<span class="loading"></span>è¿è¡Œæ€§èƒ½æµ‹è¯•...';
                updateProgress(0);

                const perfSuite = new PerformanceTestSuite();
                progressInterval = setInterval(() => {
                    const currentProgress = parseFloat(document.getElementById('progressFill').style.width || '0%');
                    if (currentProgress < 45) {
                        updateProgress(currentProgress + 2);
                    }
                }, 300);

                const perfResults = await perfSuite.runFullSuite();
                clearInterval(progressInterval);

                showResults(perfResults, 'æ€§èƒ½');
                updateProgress(50);

                // å†è¿è¡Œé›†æˆæµ‹è¯•
                button.innerHTML = '<span class="loading"></span>è¿è¡Œé›†æˆæµ‹è¯•...';

                const intSuite = new IntegrationTestSuite();
                progressInterval = setInterval(() => {
                    const currentProgress = parseFloat(document.getElementById('progressFill').style.width || '0%');
                    if (currentProgress < 95) {
                        updateProgress(currentProgress + 1.5);
                    }
                }, 400);

                const intResults = await intSuite.runFullSuite();
                clearInterval(progressInterval);

                showResults(intResults, 'é›†æˆ');
                updateProgress(100);

                // æ˜¾ç¤ºç»¼åˆè¯„ä¼°
                showCombinedSummary(perfResults, intResults);

            } catch (error) {
                console.error('å®Œæ•´æµ‹è¯•å¥—ä»¶å¤±è´¥:', error);
                clearInterval(progressInterval);
                updateProgress(0);
            }

            button.disabled = false;
            button.innerHTML = 'å¼€å§‹å®Œæ•´æµ‹è¯•å¥—ä»¶';
        }

        function showCombinedSummary(perfResults, intResults) {
            const perfScore = perfResults.overall.performanceScore;
            const intScore = intResults.overall.integrationScore;
            const combinedScore = (perfScore + intScore) / 2;

            let overallRating;
            if (combinedScore >= 90) {
                overallRating = 'ä¼˜ç§€';
            } else if (combinedScore >= 80) {
                overallRating = 'è‰¯å¥½';
            } else if (combinedScore >= 70) {
                overallRating = 'ä¸€èˆ¬';
            } else {
                overallRating = 'éœ€æ”¹è¿›';
            }

            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'summary';
            summaryDiv.innerHTML = `
                <h3>ğŸ¯ å®Œæ•´æµ‹è¯•å¥—ä»¶å®Œæˆ</h3>
                <p>ç»¼åˆè¯„åˆ†: <strong>${combinedScore.toFixed(1)}/100</strong></p>
                <p>æ€§èƒ½è¯„åˆ†: ${perfScore.toFixed(1)} | é›†æˆè¯„åˆ†: ${intScore.toFixed(1)}</p>
                <p>æ•´ä½“ç­‰çº§: <strong>${overallRating}</strong></p>
                <p>æµ‹è¯•çŠ¶æ€: âœ… æ‰€æœ‰æµ‹è¯•å®Œæˆ</p>
            `;

            const resultsDiv = document.getElementById('results');
            resultsDiv.appendChild(summaryDiv);

            // æ˜¾ç¤ºæœ€ç»ˆå»ºè®®
            const recommendationsDiv = document.createElement('div');
            recommendationsDiv.className = 'recommendations';
            recommendationsDiv.innerHTML = `
                <h4>ğŸ¯ æœ€ç»ˆä¼˜åŒ–å»ºè®®</h4>
                <ul>
                    <li>æ€§èƒ½æµ‹è¯•ç»“æœ: ${perfResults.overall.recommendations[0]}</li>
                    <li>é›†æˆæµ‹è¯•ç»“æœ: ${intResults.overall.recommendations[0]}</li>
                    <li>ç»§ç»­ç›‘æ§ç³»ç»Ÿæ€§èƒ½å’Œç¨³å®šæ€§</li>
                    <li>å®šæœŸè¿è¡Œæµ‹è¯•å¥—ä»¶ç¡®ä¿è´¨é‡</li>
                </ul>
            `;

            resultsDiv.appendChild(recommendationsDiv);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('VidSlide AI æ€§èƒ½ä¸é›†æˆæµ‹è¯•é¡µé¢å·²åŠ è½½');

            // æ£€æŸ¥URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('performance-test')) {
                setTimeout(() => runPerformanceTest(), 1000);
            } else if (urlParams.has('integration-test')) {
                setTimeout(() => runIntegrationTest(), 1000);
            } else if (urlParams.has('full-test')) {
                setTimeout(() => runFullSuite(), 1000);
            }
        });

        // å…¨å±€é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            console.error('æµ‹è¯•é¡µé¢é”™è¯¯:', e.error);
        });

        window.addEventListener('unhandledrejection', function(e) {
            console.error('æœªå¤„ç†çš„Promiseé”™è¯¯:', e.reason);
        });
    </script>
</body>
</html>