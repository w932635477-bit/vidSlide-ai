<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VidSlide AI - åŸºç¡€åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .primary { background: #007bff; color: white; }
        .secondary { background: #6c757d; color: white; }
        .success-btn { background: #28a745; color: white; }
        .warning-btn { background: #ffc107; color: black; }
        input[type="file"] {
            margin: 10px 0;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            background: #f8f9fa;
        }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        h3 { color: #555; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ VidSlide AI - åŸºç¡€åŠŸèƒ½æµ‹è¯•</h1>

        <div class="status info">
            <h3>ğŸ“Š æµ‹è¯•çŠ¶æ€</h3>
            <p>åŸºç¡€HTML/CSS/JavaScriptåŠŸèƒ½æµ‹è¯•</p>
            <div id="test-results"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•</h2>

            <h3>1ï¸âƒ£ JavaScriptåŸºç¡€åŠŸèƒ½</h3>
            <button class="primary" onclick="testBasicJS()">æµ‹è¯•JavaScript</button>
            <button class="primary" onclick="testDOM()">æµ‹è¯•DOMæ“ä½œ</button>
            <button class="primary" onclick="testLocalStorage()">æµ‹è¯•æœ¬åœ°å­˜å‚¨</button>

            <h3>2ï¸âƒ£ æ–‡ä»¶å¤„ç†åŠŸèƒ½</h3>
            <input type="file" id="videoInput" accept="video/*" onchange="handleFileSelect(event)">
            <button class="secondary" onclick="testFileAPI()">æµ‹è¯•æ–‡ä»¶API</button>
            <div id="file-info"></div>

            <h3>3ï¸âƒ£ è§†é¢‘å¤„ç†åŠŸèƒ½</h3>
            <button class="success-btn" onclick="testVideoElement()">æµ‹è¯•è§†é¢‘å…ƒç´ </button>
            <button class="success-btn" onclick="testCanvas()">æµ‹è¯•Canvas</button>
            <div id="video-test-area"></div>

            <h3>4ï¸âƒ£ AIåŠŸèƒ½å‡†å¤‡</h3>
            <button class="warning-btn" onclick="testWebAPIs()">æµ‹è¯•Web APIs</button>
            <button class="warning-btn" onclick="testSpeechAPI()">æµ‹è¯•è¯­éŸ³API</button>
            <div id="ai-test-results"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ”§ é—®é¢˜è¯Šæ–­</h2>
            <button class="secondary" onclick="checkBrowser()">æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§</button>
            <button class="secondary" onclick="checkNetwork()">æ£€æŸ¥ç½‘ç»œè¿æ¥</button>
            <button class="secondary" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
            <div id="diagnostics"></div>
        </div>

        <div class="status warning">
            <h3>âš ï¸ æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯</li>
                <li>æŸäº›åŠŸèƒ½éœ€è¦HTTPSç¯å¢ƒï¼ˆå¦‚è¯­éŸ³è¯†åˆ«ï¼‰</li>
                <li>å»ºè®®ä½¿ç”¨Chromeã€Edgeæˆ–Safariæµè§ˆå™¨</li>
                <li>Node.jså¼€å‘æœåŠ¡å™¨æœªå¯åŠ¨ï¼Œä½¿ç”¨çº¯HTMLæµ‹è¯•</li>
            </ul>
        </div>
    </div>

    <script>
        // æµ‹è¯•ç»“æœæ˜¾ç¤º
        function addResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<small>${new Date().toLocaleTimeString()}</small><br>${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // åŸºç¡€JavaScriptæµ‹è¯•
        function testBasicJS() {
            try {
                // æµ‹è¯•ES6ç‰¹æ€§
                const arrow = () => 'arrow function works';
                const template = `Template literals: ${arrow()}`;
                const promise = Promise.resolve('Promise works');
                const asyncTest = async () => 'async/await works';

                addResult('âœ… JavaScript ES6+ åŸºç¡€åŠŸèƒ½æ­£å¸¸', 'success');
            } catch (error) {
                addResult(`âŒ JavaScriptåŸºç¡€åŠŸèƒ½å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // DOMæ“ä½œæµ‹è¯•
        function testDOM() {
            try {
                const testElement = document.createElement('div');
                testElement.id = 'test-element';
                testElement.textContent = 'DOMæµ‹è¯•å…ƒç´ ';
                document.body.appendChild(testElement);

                // æµ‹è¯•querySelector
                const found = document.querySelector('#test-element');
                if (found && found.textContent === 'DOMæµ‹è¯•å…ƒç´ ') {
                    addResult('âœ… DOMæ“ä½œåŠŸèƒ½æ­£å¸¸', 'success');
                } else {
                    addResult('âŒ DOMæ“ä½œæµ‹è¯•å¤±è´¥', 'error');
                }

                // æ¸…ç†æµ‹è¯•å…ƒç´ 
                document.body.removeChild(testElement);
            } catch (error) {
                addResult(`âŒ DOMæ“ä½œå¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æœ¬åœ°å­˜å‚¨æµ‹è¯•
        function testLocalStorage() {
            try {
                const testKey = 'vidslide-test';
                const testValue = 'localStorage works';

                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);

                if (retrieved === testValue) {
                    addResult('âœ… LocalStorageåŠŸèƒ½æ­£å¸¸', 'success');
                    localStorage.removeItem(testKey);
                } else {
                    addResult('âŒ LocalStorageæµ‹è¯•å¤±è´¥', 'error');
                }
            } catch (error) {
                addResult(`âŒ LocalStorageå¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æ–‡ä»¶APIæµ‹è¯•
        function testFileAPI() {
            try {
                if (window.File && window.FileReader && window.FileList && window.Blob) {
                    addResult('âœ… File APIæ”¯æŒæ­£å¸¸', 'success');
                } else {
                    addResult('âŒ File APIä¸æ”¯æŒ', 'error');
                }
            } catch (error) {
                addResult(`âŒ File APIæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æ–‡ä»¶é€‰æ‹©å¤„ç†
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const info = document.getElementById('file-info');
                info.innerHTML = `
                    <div class="status info">
                        <strong>æ–‡ä»¶ä¿¡æ¯:</strong><br>
                        åç§°: ${file.name}<br>
                        å¤§å°: ${(file.size / 1024 / 1024).toFixed(2)} MB<br>
                        ç±»å‹: ${file.type}<br>
                        ä¿®æ”¹æ—¶é—´: ${file.lastModifiedDate?.toLocaleString() || 'æœªçŸ¥'}
                    </div>
                `;
                addResult(`ğŸ“ é€‰æ‹©æ–‡ä»¶: ${file.name}`, 'info');
            }
        }

        // è§†é¢‘å…ƒç´ æµ‹è¯•
        function testVideoElement() {
            try {
                const video = document.createElement('video');
                const testArea = document.getElementById('video-test-area');

                // æ£€æŸ¥è§†é¢‘å…ƒç´ æ”¯æŒ
                const canPlayTypes = [
                    'video/mp4; codecs="avc1.42E01E"',
                    'video/webm; codecs="vp8, vorbis"',
                    'video/ogg; codecs="theora"'
                ];

                let supportedTypes = [];
                canPlayTypes.forEach(type => {
                    if (video.canPlayType(type) !== '') {
                        supportedTypes.push(type.split(';')[0]);
                    }
                });

                if (supportedTypes.length > 0) {
                    addResult(`âœ… è§†é¢‘å…ƒç´ æ”¯æŒ: ${supportedTypes.join(', ')}`, 'success');
                    testArea.innerHTML = `
                        <div class="status success">
                            <strong>è§†é¢‘æ’­æ”¾æµ‹è¯•:</strong><br>
                            æ”¯æŒçš„æ ¼å¼: ${supportedTypes.join(', ')}<br>
                            <small>å¯ä»¥ä½¿ç”¨File APIåŠ è½½å’Œæ’­æ”¾è§†é¢‘æ–‡ä»¶</small>
                        </div>
                    `;
                } else {
                    addResult('âŒ æµè§ˆå™¨ä¸æ”¯æŒå¸¸è§è§†é¢‘æ ¼å¼', 'error');
                }
            } catch (error) {
                addResult(`âŒ è§†é¢‘å…ƒç´ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // Canvasæµ‹è¯•
        function testCanvas() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                if (ctx) {
                    // ç®€å•çš„ç»˜å›¾æµ‹è¯•
                    canvas.width = 100;
                    canvas.height = 100;
                    ctx.fillStyle = '#007bff';
                    ctx.fillRect(0, 0, 50, 50);
                    ctx.fillStyle = '#28a745';
                    ctx.fillRect(50, 50, 50, 50);

                    addResult('âœ… Canvas 2Dæ¸²æŸ“åŠŸèƒ½æ­£å¸¸', 'success');

                    const testArea = document.getElementById('video-test-area');
                    testArea.appendChild(canvas);
                    testArea.innerHTML += '<br><small>Canvasæµ‹è¯•å›¾å½¢å·²ç»˜åˆ¶</small>';
                } else {
                    addResult('âŒ Canvas 2Dä¸Šä¸‹æ–‡ä¸å¯ç”¨', 'error');
                }
            } catch (error) {
                addResult(`âŒ Canvasæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // Web APIsæµ‹è¯•
        function testWebAPIs() {
            const apis = [
                { name: 'Web Audio API', available: !!(window.AudioContext || window.webkitAudioContext) },
                { name: 'WebRTC', available: !!(window.RTCPeerConnection || window.webkitRTCPeerConnection) },
                { name: 'WebGL', available: (() => {
                    try {
                        const canvas = document.createElement('canvas');
                        return !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
                    } catch (e) { return false; }
                })() },
                { name: 'IndexedDB', available: !!(window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB) },
                { name: 'Web Workers', available: !!window.Worker },
                { name: 'WebAssembly', available: !!window.WebAssembly },
                { name: 'MediaRecorder', available: !!window.MediaRecorder }
            ];

            const aiResults = document.getElementById('ai-test-results');
            aiResults.innerHTML = '<h4>Web APIså…¼å®¹æ€§æµ‹è¯•ç»“æœ:</h4>';

            let availableCount = 0;
            apis.forEach(api => {
                const status = api.available ? 'âœ…' : 'âŒ';
                const color = api.available ? 'success' : 'error';
                aiResults.innerHTML += `<div class="status ${color}"><small>${status} ${api.name}</small></div>`;
                if (api.available) availableCount++;
            });

            addResult(`Web APIsæµ‹è¯•å®Œæˆ: ${availableCount}/${apis.length} ä¸ªAPIå¯ç”¨`, availableCount >= 4 ? 'success' : 'warning');
        }

        // è¯­éŸ³APIæµ‹è¯•
        function testSpeechAPI() {
            try {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                const SpeechSynthesis = window.speechSynthesis;

                let results = [];

                if (SpeechRecognition) {
                    results.push('âœ… Speech Recognition APIå¯ç”¨');
                } else {
                    results.push('âŒ Speech Recognition APIä¸å¯ç”¨');
                }

                if (SpeechSynthesis) {
                    results.push('âœ… Speech Synthesis APIå¯ç”¨');
                } else {
                    results.push('âŒ Speech Synthesis APIä¸å¯ç”¨');
                }

                if (location.protocol === 'https:' || location.hostname === 'localhost') {
                    results.push('âœ… HTTPS/æœ¬åœ°ç¯å¢ƒæ”¯æŒè¯­éŸ³åŠŸèƒ½');
                } else {
                    results.push('âš ï¸ éœ€è¦HTTPSç¯å¢ƒæ‰èƒ½ä½¿ç”¨è¯­éŸ³åŠŸèƒ½');
                }

                const aiResults = document.getElementById('ai-test-results');
                aiResults.innerHTML += '<h4>è¯­éŸ³APIæµ‹è¯•ç»“æœ:</h4>' +
                    results.map(r => `<div class="status ${r.includes('âŒ') ? 'error' : r.includes('âš ï¸') ? 'warning' : 'success'}">${r}</div>`).join('');

                addResult('è¯­éŸ³APIæµ‹è¯•å®Œæˆ', 'info');
            } catch (error) {
                addResult(`âŒ è¯­éŸ³APIæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æµè§ˆå™¨å…¼å®¹æ€§æ£€æŸ¥
        function checkBrowser() {
            const browserInfo = {
                userAgent: navigator.userAgent,
                language: navigator.language,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            };

            const diagnostics = document.getElementById('diagnostics');
            diagnostics.innerHTML = `
                <div class="status info">
                    <h4>æµè§ˆå™¨ä¿¡æ¯:</h4>
                    <pre>${JSON.stringify(browserInfo, null, 2)}</pre>
                </div>
            `;

            addResult('æµè§ˆå™¨ä¿¡æ¯å·²æ˜¾ç¤º', 'info');
        }

        // ç½‘ç»œè¿æ¥æ£€æŸ¥
        function checkNetwork() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            const networkInfo = {
                online: navigator.onLine,
                connection: connection ? {
                    effectiveType: connection.effectiveType,
                    downlink: connection.downlink,
                    rtt: connection.rtt
                } : 'Connection APIä¸å¯ç”¨'
            };

            const diagnostics = document.getElementById('diagnostics');
            diagnostics.innerHTML += `
                <div class="status ${navigator.onLine ? 'success' : 'error'}">
                    <h4>ç½‘ç»œçŠ¶æ€:</h4>
                    <pre>${JSON.stringify(networkInfo, null, 2)}</pre>
                </div>
            `;

            addResult(`ç½‘ç»œçŠ¶æ€: ${navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿'}`, navigator.onLine ? 'success' : 'error');
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
            document.getElementById('file-info').innerHTML = '';
            document.getElementById('video-test-area').innerHTML = '';
            document.getElementById('ai-test-results').innerHTML = '';
            document.getElementById('diagnostics').innerHTML = '';
            addResult('æ‰€æœ‰æµ‹è¯•ç»“æœå·²æ¸…é™¤', 'info');
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„è‡ªåŠ¨æµ‹è¯•
        window.addEventListener('load', () => {
            addResult('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åŸºç¡€åŠŸèƒ½æµ‹è¯•...', 'info');
            setTimeout(() => {
                testBasicJS();
                testDOM();
                testLocalStorage();
                testFileAPI();
            }, 100);
        });

        // é¡µé¢é”™è¯¯å¤„ç†
        window.addEventListener('error', (event) => {
            addResult(`é¡µé¢é”™è¯¯: ${event.message} (${event.filename}:${event.lineno})`, 'error');
        });

        // æœªæ•è·çš„Promiseé”™è¯¯
        window.addEventListener('unhandledrejection', (event) => {
            addResult(`æœªå¤„ç†çš„Promiseé”™è¯¯: ${event.reason}`, 'error');
        });
    </script>
</body>
</html>
